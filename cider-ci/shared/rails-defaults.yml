traits:
  postgresql: true
  asdf: true

templates:
  - src: [cider-ci, templates, database.yml]
    dest: [config, database.yml]

scripts:
  bundle:
    exclusive-executor-resource: rbenv
    timeout: 10 Minutes
    body: ./bin/ruby-setup

  create-database:
    body: bundle exec rake db:reset
    start-when:
    - script: bundle

  delete-database:
    body:  bundle exec rake db:pg:terminate_connections db:drop
    ignore-state: true
    start-when:
    - script: test
      states: [aborted, passed, failed, skipped]

