-#  Copyright (C) 2013, 2014 Dr. Thomas Schank  (DrTom@schank.ch, Thomas.Schank@algocon.ch)
-#  Licensed under the terms of the GNU Affero General Public License v3.
-#  See the LICENSE.txt file provided with this software.

- execution ||= @execution
- cs = execution.execution_cache_signature
- tasks ||= @tasks
#tasks.tasks

  .pull-right
    = form_tag workspace_execution_path(execution), method: 'GET', class: "form-inline well right-top-form" do
      
      %fieldset
        .pull-right
          %ul.list-inline
            %li 
              .form-group
                %label.sr-only{for: "tasks_select_condition"}
                = select_tag :tasks_select_condition, 
                  options_for_select([["All",:all],["With unsuccessful trials",:with_unsucessful_trials],
                    ["Only failed",:failed]],@tasks_select_condition), 
                  class: "form-control input-sm"

            %li
              .form-group
                %label.sr-only{for: "name_substring_term"}
                =text_field_tag :name_substring_term, nil, placeholder: "substr OR substr",
                  value: @name_substring_term, 
                  class: "search-query form-control input-sm"

            %li
              = render 'per_page_form_group'

            %li
              = link_to workspace_execution_path(execution), class: 'btn btn-sm btn-warning' do
                %i.icon-remove-sign
                Reset


            %li
              =button_tag type: 'submit', class: 'btn btn-sm btn-primary' do
                %i.icon-filter
                Filter

  %h2 Tasks 

  .clearfix

  %table#tasks-table.tasks.table.table-striped.reload{data: {cache_tag: tasks.map(&:id)}}
    %thead
    %tbody
      - tasks.each do |task| 
        = render 'task_tr', task: task


  #task-pagination.replace-without-animation.reload{data: {cache_tag: cs.tasks_signature}}
    = paginate tasks, theme: 'default'



