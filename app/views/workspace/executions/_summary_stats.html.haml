-#  Copyright (C) 2013, 2014 Dr. Thomas Schank  (DrTom@schank.ch, Thomas.Schank@algocon.ch)
-#  Licensed under the terms of the GNU Affero General Public License v3.
-#  See the LICENSE.txt file provided with this software.

- execution ||= @execution
- cs = @execution_cache_signatures ? @execution_cache_signatures.select{|cs| cs.execution_id == execution.id}.first :  execution.execution_cache_signature
- cache [cs.tasks_signature || execution.cache_signature] do |cache_tag|
  - _stat = execution.execution_stat

  #summary-stats.stats.summary-stats.reload.replace-without-animation{data: {state: execution.state, cache_tag: _stat}}
    %table.new-execution-stats
      %thead 
      %tbody
        %tr
          - Constants::EXECUTION_STATES.each do |state|
            - if _stat[state] > 0
              - fraction= _stat[state]/_stat[:total].to_f
              %td{class: state,data:{ fraction: fraction },style: "width: #{fraction*100}%"}
                =_stat[state]
                %i{class: icon_class_for_state(state)}
